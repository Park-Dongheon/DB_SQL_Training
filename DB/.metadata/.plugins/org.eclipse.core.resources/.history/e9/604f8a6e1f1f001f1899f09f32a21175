package edu.pnu;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.Scanner;

public class DriverStatementQuery {
	static String driver = "com.mysql.cj.jdbc.Driver";
	static String url = "jdbc:mysql://localhost:3306/world";
	static String username = "scott";
	static String password = "tiger";
	
	public static void main(String[] args) {
			
		Scanner sc = new Scanner(System.in);
		while(true) {
			System.out.println("=".repeat(80));
			System.out.println(">>Select[0:Exit]");
			System.out.println("1. 수도 이름과 함께 국가 이름을 검색합니다. (WHERE C.CAPITAL = CI.ID)");
			System.out.println("2. 세계에서 인구가 가장 많은 상위 5개 도시의 이름과 인구를 검색합니다. 결과를 인구별로 내림차순으로 정렬합니다. (ORDER BY POPULATION DESC)");
			System.out.println("3. 미국(United States)에 있는 모든 도시의 이름을 검색합니다.");
			System.out.println("4. 중국(China)에서 사용되는 모든 언어의 이름을 검색합니다.");
			System.out.println("5. 인구가 100만 명 이상인 유럽 국가의 이름을 검색합니다.");
			System.out.println("6. 1900년 이후 독립한 국가의 이름을 검색합니다.");
			System.out.println("7. 영어가 공용어가 아니고 국민총생산(GNP)이 1,000보다 큰 국가의 이름을 검색합니다.");
			int sel = sc.nextInt();
			System.out.println("=".repeat(80));
			if(sel == 0) break;
			switch(sel) {
			case 1: query1(); break;
			case 2: query2(); break;
			case 3: query3(); break;
			case 4: query4(); break;
			case 5: query5(); break;
			case 6: query6(); break;
			case 7: query7(); break;
			default:		  break;
			}
		}
	
	}

	private static void query1() {
		Connection con = null;
		try {
			Class.forName(driver);
			System.out.println("로딩 성공");
			
			con = DriverManager.getConnection(url, username, password);
			System.out.println("연결 성공");
			
			Statement st = con.createStatement();
			ResultSet rs = st.executeQuery("SELECT c.Name, ct.Name FROM country c, city ct WHERE c.Capital = ct.ID");
			
			while(rs.next()) {
				for(int i = 1; i <= rs.getMetaData().getColumnCount(); i++) {
					System.out.print(rs.getString(i) + ",");					
				}
				System.out.println();
			}
			rs.close();
			st.close();
			con.close();
			
		} catch (Exception e) {
			System.out.println("연결 실패 : " + e.getMessage());
		}	
	}
	private static void query2() {
		Connection con = null;
		try {
			Class.forName(driver);
			System.out.println("로딩 성공");
			
			con = DriverManager.getConnection(url, username, password);
			System.out.println("연결 성공");
			
			Statement st = con.createStatement();
			ResultSet rs = st.executeQuery("SELECT * FROM country");
			
			while(rs.next()) {
				for(int i = 1; i <= rs.getMetaData().getColumnCount(); i++) {
					System.out.print(rs.getString(i) + ",");					
				}
				System.out.println();
			}
			rs.close();
			st.close();
			con.close();
			
		} catch (Exception e) {
			System.out.println("연결 실패 : " + e.getMessage());
		}	
	}
	private static void query3() {
		Connection con = null;
		try {
			Class.forName(driver);
			System.out.println("로딩 성공");
			
			con = DriverManager.getConnection(url, username, password);
			System.out.println("연결 성공");
			
			Statement st = con.createStatement();
			ResultSet rs = st.executeQuery("SELECT * FROM country");
			
			while(rs.next()) {
				for(int i = 1; i <= rs.getMetaData().getColumnCount(); i++) {
					System.out.print(rs.getString(i) + ",");					
				}
				System.out.println();
			}
			rs.close();
			st.close();
			con.close();
			
		} catch (Exception e) {
			System.out.println("연결 실패 : " + e.getMessage());
		}	
	}
	private static void query4() {
		Connection con = null;
		try {
			Class.forName(driver);
			System.out.println("로딩 성공");
			
			con = DriverManager.getConnection(url, username, password);
			System.out.println("연결 성공");
			
			Statement st = con.createStatement();
			ResultSet rs = st.executeQuery("SELECT * FROM country");
			
			while(rs.next()) {
				for(int i = 1; i <= rs.getMetaData().getColumnCount(); i++) {
					System.out.print(rs.getString(i) + ",");					
				}
				System.out.println();
			}
			rs.close();
			st.close();
			con.close();
			
		} catch (Exception e) {
			System.out.println("연결 실패 : " + e.getMessage());
		}	
	}
	private static void query5() {
		Connection con = null;
		try {
			Class.forName(driver);
			System.out.println("로딩 성공");
			
			con = DriverManager.getConnection(url, username, password);
			System.out.println("연결 성공");
			
			Statement st = con.createStatement();
			ResultSet rs = st.executeQuery("SELECT * FROM country");
			
			while(rs.next()) {
				for(int i = 1; i <= rs.getMetaData().getColumnCount(); i++) {
					System.out.print(rs.getString(i) + ",");					
				}
				System.out.println();
			}
			rs.close();
			st.close();
			con.close();
			
		} catch (Exception e) {
			System.out.println("연결 실패 : " + e.getMessage());
		}	
	}
	private static void query6() {
		Connection con = null;
		try {
			Class.forName(driver);
			System.out.println("로딩 성공");
			
			con = DriverManager.getConnection(url, username, password);
			System.out.println("연결 성공");
			
			Statement st = con.createStatement();
			ResultSet rs = st.executeQuery("SELECT * FROM country");
			
			while(rs.next()) {
				for(int i = 1; i <= rs.getMetaData().getColumnCount(); i++) {
					System.out.print(rs.getString(i) + ",");					
				}
				System.out.println();
			}
			rs.close();
			st.close();
			con.close();
			
		} catch (Exception e) {
			System.out.println("연결 실패 : " + e.getMessage());
		}	
	}
	private static void query7() {
		Connection con = null;
		try {
			Class.forName(driver);
			System.out.println("로딩 성공");
			
			con = DriverManager.getConnection(url, username, password);
			System.out.println("연결 성공");
			
			Statement st = con.createStatement();
			ResultSet rs = st.executeQuery("SELECT * FROM country");
			
			while(rs.next()) {
				for(int i = 1; i <= rs.getMetaData().getColumnCount(); i++) {
					System.out.print(rs.getString(i) + ",");					
				}
				System.out.println();
			}
			rs.close();
			st.close();
			con.close();
			
		} catch (Exception e) {
			System.out.println("연결 실패 : " + e.getMessage());
		}	
	}
	
	
	

//	private static void citytest() {
//		Connection con = null;
//		try {
//			Class.forName(driver);
//			System.out.println("로딩 성공");
//			
//			con = DriverManager.getConnection(url, username, password);
//			System.out.println("연결 성공");
//			
//			Statement st = con.createStatement();
//			ResultSet rs = st.executeQuery("SELECT Id, Name, CountryCode, District, Population FROM city LIMIT 10");
//			
//			while(rs.next()) {
//				System.out.print(rs.getString("Id") + ",");
//				System.out.print(rs.getString("Name") + ",");
//				System.out.print(rs.getString("CountryCode") + ",");
//				System.out.print(rs.getString("District") + ",");
//				System.out.print(rs.getString("Population") + "\n");
//			}
//			
//			rs.close();
//			st.close();
//			con.close();
//
//		} catch (Exception e) {
//			System.out.println("연결 실패 : " + e.getMessage());
//		}		
//	}
//	
//	private static void countrytest() {
//		
//		Connection con = null;
//		try {
//			Class.forName(driver);
//			System.out.println("로딩 성공");
//			
//			con = DriverManager.getConnection(url, username, password);
//			System.out.println("연결 성공");
//			
//			Statement st = con.createStatement();
//			ResultSet rs = st.executeQuery("SELECT * FROM country");
//			
//			while(rs.next()) {
//				for(int i = 1; i <= rs.getMetaData().getColumnCount(); i++) {
//					System.out.print(rs.getString(i) + ",");					
//				}
//				System.out.println();
//			}
//			rs.close();
//			st.close();
//			con.close();
//			
//		} catch (Exception e) {
//			System.out.println("연결 실패 : " + e.getMessage());
//		}		
//	}

}
